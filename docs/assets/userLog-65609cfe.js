import{i as m,_ as y,d as V,r as I,o as C,c as P,a as d,b as t,w as a,F as E,e as r,t as k}from"./index-c4b406ba.js";import{E as v,a as T,b as U}from"./el-table-column-40dd5d89.js";import{E as F,a as z,b as B,c as D}from"./el-form-item-0c6e9fab.js";import{a as $,E as N}from"./user-eb0ed749.js";import{E as p}from"./el-tag-6021fadc.js";import{E as S}from"./el-pagination-ba5a53ac.js";import{T as W}from"./TPaginationSelect-0de40698.js";/* empty css                   */import"./index-3a017d50.js";function O(e){return m({url:"/api/userLog/page",method:"post",data:e})}function A(e){return m({url:"/api/userLog/page/user",method:"post",data:e})}function K(e){return m({url:"/api/userLog/add",method:"post",data:e})}const M=V({data(){return{userLogs:[],userInfos:[],page:{total:0,current:1,size:6},selectPage:{total:0,current:1,size:6,pagerCount:5},userInfos:[],searchId:null,dialogFormVisible:!1,userLog:{createTime:new Date,id:0,log:"",userId:0},formLabelWidth:80}},mounted(){this.getLogsPage(1),this.getUserInfosPage(1)},components:{"t-pagination-select":W},methods:{pageChange(e){this.getUserInfosPage(e)},getUserInfosPage(e){$({current:e,size:6}).then(s=>{const n=s.data.page;this.userInfos=n.records,this.selectPage=n}).catch(s=>{console.log(s)})},search(){if(this.searchId==null||this.searchId==""){alert("请输入用户编号后查询");return}const e={current:1,size:6,colums:[],userId:this.searchId};A(e).then(o=>{console.log(o);const s=o.data.page;this.userLogs=s.records,this.page=s}).catch(o=>{console.log(o)})},research(){this.searchId=null,this.getLogsPage(1)},getLogsPage(e){O({current:e,size:6,colums:[]}).then(s=>{console.log(s);const n=s.data.page;this.userLogs=n.records,this.page=n}).catch(s=>{console.log(s)})},currentchange(e){this.getLogsPage(e),this.page.current=e},toAdd(){this.dialogFormVisible=!0,this.userLog={createTime:new Date,id:0,log:""}},save(){const e=this.userLog;e.id==0&&K(e).then(o=>{if(o.success)this.dialogFormVisible=!1,this.getLogsPage(this.page.current),p(o.msg);else return p(o.msg),!1}).catch(o=>{p("网络错误联系管理员")})}}}),j={style:{"margin-top":"10px"}},q={style:{width:"95%",margin:"0 auto"}},G={style:{width:"95%",margin:"0 auto"}},H={class:"block"},J={class:"dialog-footer"};function Q(e,o,s,n,R,X){const c=B,g=F,i=z,u=U,h=v,f=S,_=I("t-pagination-select"),b=N,L=D,w=T;return C(),P(E,null,[d("div",j,[d("div",q,[t(g,{label:"用户编号","label-width":80,style:{display:"inline-flex","margin-right":"10px"}},{default:a(()=>[t(c,{modelValue:e.searchId,"onUpdate:modelValue":o[0]||(o[0]=l=>e.searchId=l),placeholder:"请输入用户编号"},null,8,["modelValue"])]),_:1}),t(i,{type:"primary",onClick:e.search},{default:a(()=>[r("查询")]),_:1},8,["onClick"])]),d("div",G,[t(i,{type:"info",onClick:e.research},{default:a(()=>[r("重置")]),_:1},8,["onClick"]),t(i,{type:"success",onClick:e.toAdd},{default:a(()=>[r("添加 ")]),_:1},8,["onClick"])]),t(h,{data:e.userLogs,style:{width:"95%",margin:"0 auto"}},{default:a(()=>[t(u,{prop:"id",label:"编号",width:"100"}),t(u,{prop:"userId",label:"用户编号",sortable:"",width:"150"}),t(u,{prop:"log",label:"日志内容",width:"150"}),t(u,{label:"创建时间",width:"200"},{default:a(l=>[r(k(l.row.createTime!=null?l.row.createTime.replace("T"," ").slice(0,19):""),1)]),_:1})]),_:1},8,["data"]),t(f,{layout:"prev, pager, next","page-size":e.page.size,total:e.page.total,style:{width:"95%",margin:"0 auto"},onCurrentChange:e.currentchange},null,8,["page-size","total","onCurrentChange"])]),t(w,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":o[5]||(o[5]=l=>e.dialogFormVisible=l),title:"日志编辑"},{footer:a(()=>[d("span",J,[t(i,{onClick:o[4]||(o[4]=l=>e.dialogFormVisible=!1)},{default:a(()=>[r("取消")]),_:1}),t(i,{type:"primary",onClick:e.save},{default:a(()=>[r("保存 ")]),_:1},8,["onClick"])])]),default:a(()=>[t(L,{model:e.userLog},{default:a(()=>[t(g,{label:"用户名称","label-width":e.formLabelWidth},{default:a(()=>[t(_,{onPageChange:e.pageChange,optionSource:e.userInfos,modelValue:e.userLog.userId,"onUpdate:modelValue":o[1]||(o[1]=l=>e.userLog.userId=l),labelKey:"userName",valueKey:"id",style:{width:"90%"},placeholder:"请选择用户名称",paginationOption:e.selectPage},null,8,["onPageChange","optionSource","modelValue","paginationOption"])]),_:1},8,["label-width"]),t(g,{label:"日志内容","label-width":e.formLabelWidth},{default:a(()=>[t(c,{type:"textarea",row:3,style:{width:"80%"},modelValue:e.userLog.log,"onUpdate:modelValue":o[2]||(o[2]=l=>e.userLog.log=l),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),t(g,{label:"创建时间","label-width":e.formLabelWidth},{default:a(()=>[d("div",H,[t(b,{modelValue:e.userLog.createTime,"onUpdate:modelValue":o[3]||(o[3]=l=>e.userLog.createTime=l),type:"datetime",placeholder:"请选择创建时间"},null,8,["modelValue"])])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}const ne=y(M,[["render",Q],["__scopeId","data-v-2a746aec"]]);export{ne as default};
