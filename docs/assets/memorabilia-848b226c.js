import{i as h,_ as T,d as k,r as P,o as I,c as E,a as m,b as l,w as o,F as v,e as i,t as c}from"./index-c9c38515.js";import{E as F,a as U,b as D}from"./el-table-column-4aba63cb.js";import{E as z,a as M,b as $,c as L}from"./el-form-item-6aec74e8.js";import{a as O,E as W}from"./user-6581bd27.js";import{E as p}from"./el-tag-b03013a1.js";import{E as B}from"./el-pagination-20cdb6f6.js";import{T as N}from"./TPaginationSelect-5e920801.js";/* empty css                   */import{c as S}from"./cloneDeep-3c2f2a77.js";import"./index-5597c1ec.js";function A(e){return h({url:"/api/memorabilia/page",method:"post",data:e})}function K(e){return h({url:`/api/memorabilia/one/${e}`,method:"get"})}function j(e){return h({url:`/api/memorabilia/delete/${e}`,method:"get"})}function q(e){return h({url:"/api/memorabilia/add",method:"post",data:e})}function G(e){return h({url:"/api/memorabilia/edit",method:"post",data:e})}const H=k({data(){return{memorabilias:[],page:{total:0,current:1,size:6},searchId:null,selectPage:{total:0,current:1,size:6,pagerCount:5},dialogFormVisible:!1,memorabilia:{content:"",createTime:new Date,happenTime:new Date,id:0,updateTime:new Date},formLabelWidth:80}},mounted(){this.getMemorabiliasPage(1),this.getUserInfosPage(1)},components:{"t-pagination-select":N},methods:{pageChange(e){this.getUserInfosPage(e)},getUserInfosPage(e){O({current:e,size:6}).then(n=>{const d=n.data.page;this.userInfos=d.records,this.selectPage=d}).catch(n=>{console.log(n)})},search(){if(this.searchId==null||this.searchId==""){alert("请输入大事件编号后查询");return}K(this.searchId).then(e=>{e.data==null?this.memorabilias=[]:(this.memorabilias=[],this.memorabilias.push(e.data.memorabilia))}).catch(e=>{console.log(e)})},research(){this.searchId=null,this.getMemorabiliasPage(1)},toEdit(e){this.dialogFormVisible=!0,this.memorabilia=S(e)},getMemorabiliasPage(e){A({current:e,size:6,userId:11,colums:[]}).then(n=>{console.log(n);const d=n.data.page;this.memorabilias=d.records,this.page=d}).catch(n=>{console.log(n)})},currentchange(e){this.getMemorabiliasPage(e),this.page.current=e},del(e){confirm("是否删除")==!0&&console.log(e),console.log(e),j(e).then(a=>{if(a.success)this.getMemorabiliasPage(this.page.current);else return!1}).catch(a=>{})},toAdd(){this.dialogFormVisible=!0,this.memorabilia={content:"",createTime:new Date,happenTime:new Date,id:0,updateTime:new Date}},save(){const e=this.memorabilia;e.id==0?q(e).then(a=>{if(a.success)this.dialogFormVisible=!1,this.getMemorabiliasPage(this.page.current),p(a.msg);else return p(a.msg),!1}).catch(a=>{p("网络错误联系管理员")}):G(e).then(a=>{if(a.success)this.dialogFormVisible=!1,this.getMemorabiliasPage(this.page.current),p(a.msg);else return p(a.msg),!1}).catch(a=>{p("网络错误联系管理员")})}}}),J={style:{"margin-top":"10px"}},Q={style:{width:"95%",margin:"0 auto"}},R={style:{width:"95%",margin:"0 auto"}},X={class:"block"},Y={class:"block"},Z={class:"block"},x={class:"dialog-footer"};function ee(e,a,n,d,ae,le){const b=$,u=z,s=M,r=D,f=F,w=B,_=P("t-pagination-select"),g=W,V=L,y=U;return I(),E(v,null,[m("div",J,[m("div",Q,[l(u,{label:"大事件编号","label-width":95,style:{display:"inline-flex","margin-right":"10px"}},{default:o(()=>[l(b,{modelValue:e.searchId,"onUpdate:modelValue":a[0]||(a[0]=t=>e.searchId=t),placeholder:"请输入大事件编号"},null,8,["modelValue"])]),_:1}),l(s,{type:"primary",onClick:e.search},{default:o(()=>[i("查询")]),_:1},8,["onClick"])]),m("div",R,[l(s,{type:"info",onClick:e.research},{default:o(()=>[i("重置")]),_:1},8,["onClick"]),l(s,{type:"success",onClick:e.toAdd},{default:o(()=>[i("添加 ")]),_:1},8,["onClick"])]),l(f,{data:e.memorabilias,style:{width:"95%",margin:"0 auto"}},{default:o(()=>[l(r,{prop:"id",label:"编号",width:"80"}),l(r,{prop:"userId",label:"用户编号",width:"100"}),l(r,{prop:"content",label:"发生内容",width:"180"}),l(r,{label:"发生时间",width:"200"},{default:o(t=>[i(c(t.row.happenTime!=null?t.row.happenTime.replace("T"," ").slice(0,19):""),1)]),_:1}),l(r,{label:"创建时间",width:"150"},{default:o(t=>[i(c(t.row.createTime!=null?t.row.createTime.replace("T"," ").slice(0,19):""),1)]),_:1}),l(r,{label:"修改时间",width:"150"},{default:o(t=>[i(c(t.row.updateTime!=null?t.row.updateTime.replace("T"," ").slice(0,19):""),1)]),_:1}),l(r,{fixed:"right",label:"功能管理",width:"140"},{default:o(t=>[l(s,{type:"warning",link:"",size:"small",onClick:C=>e.toEdit(t.row)},{default:o(()=>[i("更新")]),_:2},1032,["onClick"]),l(s,{type:"danger",link:"",size:"small",onClick:C=>e.del(t.row.id)},{default:o(()=>[i("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),l(w,{layout:"prev, pager, next","page-size":e.page.size,total:e.page.total,style:{width:"95%",margin:"0 auto"},onCurrentChange:e.currentchange},null,8,["page-size","total","onCurrentChange"])]),l(y,{modelValue:e.dialogFormVisible,"onUpdate:modelValue":a[7]||(a[7]=t=>e.dialogFormVisible=t),title:"用户编辑"},{footer:o(()=>[m("span",x,[l(s,{onClick:a[6]||(a[6]=t=>e.dialogFormVisible=!1)},{default:o(()=>[i("取消")]),_:1}),l(s,{type:"primary",onClick:e.save},{default:o(()=>[i("保存 ")]),_:1},8,["onClick"])])]),default:o(()=>[l(V,{model:e.memorabilia},{default:o(()=>[l(u,{label:"用户名称","label-width":e.formLabelWidth},{default:o(()=>[l(_,{onPageChange:e.pageChange,optionSource:e.userInfos,modelValue:e.memorabilia.userId,"onUpdate:modelValue":a[1]||(a[1]=t=>e.memorabilia.userId=t),labelKey:"userName",valueKey:"id",style:{width:"90%"},placeholder:"请选择用户名称",paginationOption:e.selectPage},null,8,["onPageChange","optionSource","modelValue","paginationOption"])]),_:1},8,["label-width"]),l(u,{label:"发生内容","label-width":e.formLabelWidth},{default:o(()=>[l(b,{type:"textarea",placeholder:"请输入发生内容",row:3,style:{width:"80%"},modelValue:e.memorabilia.content,"onUpdate:modelValue":a[2]||(a[2]=t=>e.memorabilia.content=t),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label-width"]),l(u,{label:"发生时间","label-width":e.formLabelWidth},{default:o(()=>[m("div",X,[l(g,{modelValue:e.memorabilia.happenTime,"onUpdate:modelValue":a[3]||(a[3]=t=>e.memorabilia.happenTime=t),type:"datetime",placeholder:"请选择发生时间"},null,8,["modelValue"])])]),_:1},8,["label-width"]),l(u,{label:"创建时间","label-width":e.formLabelWidth},{default:o(()=>[m("div",Y,[l(g,{modelValue:e.memorabilia.createTime,"onUpdate:modelValue":a[4]||(a[4]=t=>e.memorabilia.createTime=t),type:"datetime",placeholder:"请选择创建时间"},null,8,["modelValue"])])]),_:1},8,["label-width"]),l(u,{label:"修改时间","label-width":e.formLabelWidth},{default:o(()=>[m("div",Z,[l(g,{modelValue:e.memorabilia.updateTime,"onUpdate:modelValue":a[5]||(a[5]=t=>e.memorabilia.updateTime=t),type:"datetime",placeholder:"请选择修改时间"},null,8,["modelValue"])])]),_:1},8,["label-width"])]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}const he=T(H,[["render",ee],["__scopeId","data-v-4f716582"]]);export{he as default};
